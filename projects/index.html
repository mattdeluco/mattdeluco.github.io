<!doctype html><html prefix="og: http://ogp.me/ns#" lang=en-ca><head itemscope itemtype=https://delu.co/>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta property="og:locale" content="en">
<meta name=language content="en">
<title itemprop=name>Matt DeLuco &#183; Projects</title>
<meta property="og:title" content="Matt DeLuco &#183; Projects">
<meta itemprop=name content="Matt DeLuco &#183; Projects">
<meta property="og:site_name" content="Matt DeLuco">
<base href=https://delu.co/projects/>
<link rel=canonical href=https://delu.co/projects/ itemprop=url>
<meta name=url content="https://delu.co/projects/">
<meta property="og:url" content="https://delu.co/projects/">
<meta itemprop=image content="https://delu.co/images/avatar.jpg">
<meta property="og:image" content="https://delu.co/images/avatar.jpg">
<meta property="og:type" content="article">
<meta itemprop=description content="Matt DeLuco has a B.Sc. in Computer Science (Magna Cum Laude) and broad interests in Software Engineering, working with his hands, and varieties of skiing and cycling.">
<meta property="og:description" content="Matt DeLuco has a B.Sc. in Computer Science (Magna Cum Laude) and broad interests in Software Engineering, working with his hands, and varieties of skiing and cycling.">
<meta name=description content="Matt DeLuco has a B.Sc. in Computer Science (Magna Cum Laude) and broad interests in Software Engineering, working with his hands, and varieties of skiing and cycling.">
<meta property="article:published_time" content="2021-10-08T08:38:00-04:00">
<meta property="og:updated_time" content="2021-10-08T08:38:00-0400">
<meta name=twitter:card content="summary">
<meta name=twitter:image content="https://delu.co/images/avatar.jpg">
<meta name=twitter:label1 value="Reading time">
<meta name=twitter:data1 value="5 minutes">
<meta name=twitter:label2 value=Published>
<meta name=twitter:data2 value="October 8, 2021">
<meta name=twitter:title content="Matt DeLuco &#183; Projects">
<meta name=twitter:description content="Matt DeLuco has a B.Sc. in Computer Science (Magna Cum Laude) and broad interests in Software Engineering, working with his hands, and varieties of skiing and cycling.">
<meta name=twitter:site content="@MattDeLuco">
<meta name=twitter:creator content="@MattDeLuco">
<link rel=icon type=image/png href=https://delu.co/images/favicon/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=https://delu.co/images/favicon/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=https://delu.co/images/favicon/favicon-96x96.png sizes=96x96>
<link rel=mask-icon href=https://delu.co/images/favicon/safari-pinned-tab.svg>
<link rel=apple-touch-icon href=https://delu.co/images/favicon/favicon-96x96.png>
<meta name=generator content="Hugo 0.88.1">
<link rel=dns-prefetch href=//fonts.googleapis.com>
<link rel=preconnect href=https://fonts.gstatic.com/ crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel=stylesheet>
<link rel=stylesheet href=https://delu.co/css/styles.min.ef433e47a104e30937dfad230e28b6dd329c9b4fe18ff4925850da1f24df3133.css integrity="sha256-70M+R6EE4wk3360jDii23TKcm0/hj/SSWFDaHyTfMTM=">
<link href=/index.xml rel=alternate type=application/rss+xml title="Matt DeLuco">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1RF1DE0RP0"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-1RF1DE0RP0')</script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js></script>
</head>
<body class="bg-gradient flex flex-col min-h-screen">
<header id=header class="w-full m-0 fixed z-10 transition-all duration-300 ease-in-out border-t-4 border-gray-300 backdrop-filter-blur">
<div id=header-container class="max-w-7xl mx-auto p-6 flex items-center flex-wrap lg:flex-no-wrap relative justify-between">
<a href=https://delu.co/ class="tracking-tighter leading-10 text-3xl font-semibold text-gray-600 flex flex-shrink-0">
Matt DeLuco
</a>
<div class="block lg:hidden mx-2">
<button class="nav-button w-10 h-10 justify-center flex items-center opacity-75 hover:opacity-100 transition duration-300 ease-in-out"><svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"/></svg>
</button>
<button class="hidden nav-button w-10 h-10 justify-center flex items-center opacity-75 hover:opacity-100 transition duration-300 ease-in-out"><svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Close menu</title><polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"/></svg>
</button>
</div>
<div class="absolute right-8 top-16 lg:relative lg:right-0 lg:top-0 flex flex-col lg:flex-row items-center rounded-md bg-white shadow lg:bg-transparent lg:shadow-none">
<nav id=nav-social-links class="p-4 lg:p-0 text-gray-600 hidden lg:block lg:order-last w-full lg:w-auto lg:ml-3">
<ul class="flex justify-end">
<li>
<a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Linkedin href=https://linkedin.com/in/mattdeluco rel=me><svg class="fill-current w-5 h-5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144.0-2.063-.926-2.063-2.065.0-1.138.92-2.063 2.063-2.063 1.14.0 2.064.925 2.064 2.063.0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0h.003z"/></svg>
</a>
</li>
<li>
<a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Twitter href=https://www.twitter.com/MattDeLuco rel=me><svg class="fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Twitter</title><path d="M6.29 18.25c7.55.0 11.67-6.25 11.67-11.67v-.53c.8-.59 1.49-1.3 2.04-2.13-.75.33-1.54.55-2.36.65a4.12 4.12.0 001.8-2.27c-.8.48-1.68.81-2.6 1a4.1 4.1.0 00-7 3.74 11.65 11.65.0 01-8.45-4.3 4.1 4.1.0 001.27 5.49C2.01 8.2 1.37 8.03.8 7.7v.05a4.1 4.1.0 003.3 4.03 4.1 4.1.0 01-1.86.07 4.1 4.1.0 003.83 2.85A8.23 8.23.0 010 16.4a11.62 11.62.0 006.29 1.84"/></svg>
</a>
</li>
<li>
<a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Github href=https://www.github.com/mattdeluco rel=me><svg class="fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>GitHub</title><path d="M10 0A10 10 0 006.84 19.49c.5.1.68-.22.68-.48l-.01-1.7c-2.78.6-3.37-1.34-3.37-1.34-.46-1.16-1.11-1.47-1.11-1.47-.9-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.9 1.52 2.34 1.08 2.91.83.1-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.94.0-1.1.39-1.99 1.03-2.69a3.6 3.6.0 01.1-2.64s.84-.27 2.75 1.02a9.58 9.58.0 015 0c1.91-1.3 2.75-1.02 2.75-1.02.55 1.37.2 2.4.1 2.64.64.7 1.03 1.6 1.03 2.69.0 3.84-2.34 4.68-4.57 4.93.36.31.68.92.68 1.85l-.01 2.75c0 .26.18.58.69.48A10 10 0 0010 0"/></svg>
</a>
</li>
<li>
<a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=stackoverflow href=https://stackoverflow.com/users/255008 rel=me><svg class="fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>stackoverflow</title><path d="M14.148438 12.902344h1.769531V20H0V12.902344H1.769531v5.324218H14.148438zm0 0"/><path d="M3.695312 12.375l8.6875 1.832031.363282-1.742187L4.0625 10.632812zM4.84375 8.203125l8.046875 3.757813.75-1.613282L5.59375 6.589844zM7.070312 4.242188l6.824219 5.699218 1.132813-1.367187L8.207031 2.875zM11.472656.03125l-1.421875 1.0625 5.296875 7.144531 1.425782-1.0625zm-7.9375 16.421875h8.84375V14.675781H3.535156zm0 0"/></svg>
</a>
</li>
<li>
<a class="block p-2 opacity-75 hover:opacity-100 transition duration-300 ease-in-out" title=Email href=mailto:matt@deluco.net><svg class="fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V4e2c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5.0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
</a>
</li>
</ul>
</nav>
<nav id=nav-menu class="p-4 lg:p-0 hidden lg:block w-full lg:w-auto text-gray-600">
<ul class="w-full flex flex-col lg:flex-row justify-end items-end lg:items-center">
<li class="flex my-2 lg:my-2 mx-1 lg:mx-2">
<a title=Now class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out" href=/now>Now</a>
</li>
<li class="flex my-2 lg:my-2 mx-1 lg:mx-2">
<a title=Career class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out" href=/career>Career</a>
</li>
<li class="flex my-2 lg:my-2 mx-1 lg:mx-2">
<a title=Projects class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out" href=/projects>Projects</a>
</li>
<li class="flex my-2 lg:my-2 mx-1 lg:mx-2">
<a title=About class="uppercase font-bold lg:py-2 lg:px-3 rounded text-sm opacity-75 hover:opacity-100 transition duration-300 ease-in-out" href=/about>About</a>
</li>
</ul>
</nav>
</div>
</div>
</header>
<main class="flex-1 mt-12 max-w-3xl mt-32 mx-auto text-gray-700 w-full">
<div id=reading-progress-bar role=presentation class="fixed z-10 top-0 left-0 h-1 bg-gray-700"></div>
<article class=article>
<h1 class=leading-9><a href=https://delu.co/projects/ class="no-underline text-black">Projects</a></h1>
<div class=article__content>
<p>🚧 Personal Financial Planning SaaS Project 🚧</p>
<blockquote class=twitter-tweet><p lang=en dir=ltr>🚧 Personal Financial Planning SaaS Project 🚧<br><br>This project started with a spreadsheet Christmas 2011. I have 11 years of meticulously organized personal financial data; excel just doesn't cut it anymore.<br><br>This isn't the first such app, probably not the last, but it's mine. 👇</p>&mdash; Matt DeLuco (@MattDeLuco) <a href="https://twitter.com/MattDeLuco/status/1381814633951072257?ref_src=twsrc%5Etfw">April 13, 2021</a></blockquote>
<script async src=https://platform.twitter.com/widgets.js></script>
<p>Follow me and my long-lived <a href=https://twitter.com/MattDeLuco/status/1381814633951072257>Twitter Thread</a>
where I post updates to the project as they happen!</p>
<h2 id=database>Database</h2>
<ul>
<li>PostgreSQL</li>
<li>Heavy on: normalization, triggers, sql and pl/pgsql functions</li>
</ul>
<p>The primary focus of this project is the database - after all, I believe data <em>is</em> the application.</p>
<p>Having forgotten my high school accounting education, my original personal finances spreadsheet was
an approximation of double entry accounting. Each line in the transactions table consisted of a bank
account, a category, and optionally a sub-category - each of these could be considered a &ldquo;T account&rdquo;.
Where I diverged from double-entry accounting is that each transaction was represented only by a single
entry - one line recording both debits and credits:</p>
<p><code>Tue, Apr 29, 2014 | VISA | Starbucks | ($2.78) | Dining | Coffee</code></p>
<p>When it came time to formalize my implementation (build this app) I rediscovered double entry accounting
as a means of categorizing transactions. And so I set out to model double entry accounting in PostgreSQL,
with an added feature: an API to the database, written natively in the database using PL/PGSQL, to
abstract the underlying model. This API would accept JSON as input and return JSON as output and requires
little intervention from the backend (session management and adding auth info to the SQL API payload.)</p>
<p>The example below is the double-entry version of the example above (in the database, some normalization
takes place.) A credit is applied to increase the liability account (VISA) while a debit is applied to
increase the expense account (Dining/Coffee):</p>
<pre tabindex=0><code>Tue, Apr 29, 2014 | Starbucks | $2.78 | CR | VISA   |
Tue, Apr 29, 2014 | Starbucks | $2.78 | DR | Dining | Coffee
</code></pre><h3 id=sql-api>SQL API</h3>
<p>I don&rsquo;t recall from where I got this idea, but I wanted to try building a database with a &ldquo;native API&rdquo; -
which is to say, an API to the database on the database built with sql and the included procedural language.
This is <a href=https://sive.rs/pg>not a new</a> or <a href="https://twitter.com/adamhjk/status/1440406931080843271?s=21">original idea</a>.</p>
<p>I believe strongly that a database should be designed with data integrity in mind, and one of the means of
maintaining integrity is to define the ways in which it is possible to interact with the database. It
should not be necessary to rebuild this API in each client that wishes to interact with the database.</p>
<p>Further, with the <a href=https://www.postgresql.org/docs/13/datatype-json.html>advent of JSON</a> <a href=https://www.postgresql.org/docs/13/functions-json.html>in PostgreSQL</a>
I thought it would be novel to create a typical CRUD API with JSON inputs and outputs, similar to a REST
API. The backend webserver then becomes an HTTP proxy to the database, responsible for session management
but otherwise passing JSON (i.e. <em>data</em>) from the frontend directly to the database.</p>
<p>There are five schemas in the database each with at least the four basic CRUD operations. These are written
in a combination of sql and plpgsql functions, many using Common Table Expressions (CTEs) to query the JSON
and do one or more actions as a result (e.g. INSERT or UPDATE.)</p>
<h4 id=json>JSON</h4>
<p>The following is a small example of how JSON is used in this database - a function that updates a journal entry:</p>
<pre tabindex=0><code>CREATE OR REPLACE FUNCTION journal.update_journal(in_json JSON)
RETURNS JSON
AS $$
  WITH results AS (
    UPDATE journal.journal j SET
      transaction_date=x.transaction_date,
      posted_date=x.posted_date,
      description=x.description
    FROM json_populate_recordset(null::journal.journal, in_json-&gt;'data') as x
    WHERE
      j.client_id = (in_json#&gt;&gt;'{context, client_id}')::BIGINT
      AND j.id = x.id
    RETURNING j.id
  ) SELECT json_agg(r) FROM results r;
$$ LANGUAGE sql;
</code></pre><p>Taking advantage of Postgres' <a href=https://www.postgresql.org/docs/13/functions-json.html>JSON Functions and Operators</a>
it&rsquo;s possible to reference various properties of the JSON input. For example, <code>in_json#>>'{context, client_id}'</code> extracts
a value from this structure:</p>
<pre tabindex=0><code>{
    &quot;context&quot;: {
        &quot;client_id&quot;: 1234
    },
    &quot;data&quot;: [...]
}
</code></pre><p>While <code>json_populate_recordset(null::journal.journal, in_json->'data')</code> expands the data array
property into a set of rows whose type is that of the journal schema&rsquo;s journal table (so matching
the column types to the corresponding JSON properties for each array element.)</p>
<h3 id=pgtap>pgtap</h3>
<p>One of the absolute best tools for developing a database, <a href=https://pgtap.org>pgtap.org</a> by
<a href=https://twitter.com/theory>David E. Wheeler</a> is a tool for unit testing databases. It is
used extensively throughout this project to validate the functionality of the API described
earlier with 16 test suites and over 150 unit tests.</p>
<p>The following is an example of the test output for a suite that verifies the functionality of
the <code>journal.add_split()</code> API:</p>
<pre tabindex=0><code>    # Subtest: tests.test_journal_split_transaction()                           
    ok 1 - Create split transaction - groceries/household from chequing         
    ok 2 - Create split transaction - groceries/household from chequing/visa    
    1..2                                                                        
ok 16 - tests.test_journal_split_transaction
</code></pre><h3 id=sqitch>sqitch</h3>
<p>From the same author as pgtap is <a href=http://sqitch.org>sqitch.org</a>:</p>
<blockquote>
<p>Sensible database-native change management for framework-free development and dependable deployment.</p>
</blockquote>
<p>Sqitch provides tools to help manage database migrations, it is a relatively new tool for
this project, but the project has been fully &ldquo;ported&rdquo; to the tool.</p>
<h2 id=backend>Backend</h2>
<ul>
<li>Nodejs</li>
<li>TODO</li>
</ul>
<h2 id=frontend>Frontend</h2>
<ul>
<li>Vuejs</li>
<li>TODO</li>
</ul>
<h2 id=competition>Competition</h2>
<p>The following are a list of similar applications to serve as reference and inspiration.</p>
<ul>
<li><a href=https://billi.app>Billi</a> 🇨🇦</li>
<li><a href=https://lunchmoney.app>Lunch Money</a></li>
<li><a href=https://mint.intuit.com>Mint.com</a></li>
<li><a href=https://wealthica.com>Wealthica</a> 🇨🇦</li>
</ul>
</div>
<section class="my-5 pt-10 pb-5 border-t border-gray-400 flex items-center">
<img alt="Avatar photo" class="border border-gray-400 p-1 w-10 h-10 rounded-full mr-3" src=/images/avatar.jpg>
<span class=flex-grow>Matt DeLuco has a B.Sc. in Computer Science (Magna Cum Laude) and broad interests in Software Engineering, working with his hands, and varieties of skiing and cycling.</span>
</section>
</article>
</main><footer class="w-full max-w-7xl mx-auto text-center border-t border-gray-200 py-9 px-3 mt-9 pin-b text-sm text-gray-500">
Made with <a href=https://gohugo.io class="underline transition duration-300 ease-in-out hover:text-blue-600">Hugo</a> and <a href=https://github.com/leonardofaria/bento class="underline transition duration-300 ease-in-out hover:text-blue-600">Bento theme</a>.
Copyright © 2021 Matt DeLuco
</footer>
<script>var initMenu=()=>{var a=document.querySelectorAll('.nav-button'),c=document.querySelector('#nav-menu'),b=document.querySelector('#nav-social-links'),d;for(d of a)d.addEventListener('click',()=>{console.log('click'),c.classList.toggle("hidden"),b&&b.classList.toggle("hidden");for(var d of a)d.classList.toggle("hidden")})};document.addEventListener('turbolinks:load',initMenu())</script>
<script>var initHeader=()=>{var a,i,f,g,e;let d=window.scrollY;a=document.querySelector('#header'),i=document.querySelector("#header-container"),f=document.querySelector("#reading-progress-bar");let b=0,c=0,h=0;g=()=>{a.classList.add("shadow"),a.classList.add("bg-white-90")},e=()=>{a.classList.remove("shadow"),a.classList.remove("bg-white-90")},window.onscroll=function(){d=window.scrollY,b=document.documentElement.scrollTop||document.body.scrollTop,c=(document.documentElement.scrollHeight||document.body.scrollHeight)-document.documentElement.clientHeight,h=b/c*100,f.style.width=b/c*100+'%',d>0?g():e()}};document.addEventListener('turbolinks:load',initHeader())</script>
</body>
</html>